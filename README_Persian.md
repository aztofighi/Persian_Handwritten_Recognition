# گزارش فنی - تشخیصگر اعداد فارسی با استفاده از GPU

این گزارش فنی شرح پیاده‌سازی یک تشخیصگر اعداد فارسی با استفاده از GPU است. تشخیصگر بر روی مجموعه داده Hoda آموزش داده شده است که شامل تصاویر دست‌نوشته اعداد فارسی است. مدل ResNet-50 برای آموزش استفاده شده و تشخیصگر دقت بالایی را بر روی تصاویر آزمون به دست می‌آورد.

## مجموعه داده

مجموعه داده Hoda برای آموزش و آزمون تشخیصگر اعداد فارسی استفاده می‌شود. این مجموعه داده شامل دو بخش است: مجموعه آموزش با 60,000 تصویر و مجموعه آزمون با 20,000 تصویر. این مجموعه داده از مخزن GitHub [aztofighi/Persian_Handwritten_Recognition](https://github.com/aztofighi/Persian_Handwritten_Recognition) دریافت شده است.

## پیش‌پردازش

قبل از آموزش مدل، تصاویر با استفاده از مراحل زیر پیش‌پردازش می‌شوند:

1. تغییر اندازه: تصاویر با استفاده از تابع `transforms.Resize` از ماژول `torchvision.transforms` به اندازه ثابت 32x32 پیکسل تغییر اندازه می‌دهند.
2. نرمال‌سازی: مقادیر پیکسل‌های تغییر اندازه شده با استفاده از تابع `transforms.Normalize` با میانگین (0.5, 0.5, 0.5) و انحراف معیار (0.5, 0.5, 0.5) نرمال می‌شوند.

## معماری مدل

مدل ResNet-50 به عنوان بخش اصلی (backbone) برای تشخیصگر اعداد فارسی استفاده می‌شود. این مدل ابتدا روی مجموعه داده ImageNet آموزش دیده و سپس روی مجموعه داده Hoda به صورت fine-tuning ادامه آموزش می‌دهد. لایه متصل به صورت کامل (fully connected layer) مدل با یک لایه خطی جدید جایگزین می‌شود که تعداد واحدهای خروجی آن با تعداد کلاس‌ها در مجموعه داده Hoda برابر است.

## آموزش

مدل با استفاده از پارامترهای زیر آموزش داده می‌شود:

- تعداد دوره‌ها (epochs): 2
- اندازه دسته (batch size): 100
- نرخ یادگیری (learning rate): 0.001

حلقه آموزش بر روی مجموعه داده آموزش برای تعداد دوره‌های مشخص شده تکرار می‌شود. تابع خطا به کار رفته تابع خطاهای همانسازی متقاطع است و بهینه‌ساز انتخاب شده Adam است. خطای آموزش برای هر دوره ذخیره شده و برای نمایش نمودار ذخیره می‌شود.

## آزمون

پس از آموزش، مدل بر روی مجموعه داده آزمون ارزیابی می‌شود تا دقت آن را اندازه‌گیری کند. مدل با استفاده از دستور `model.eval()` به حالت ارزیابی تنظیم می‌شود و تصاویر آزمون از طریق مدل عبور می‌کنند. برچسب‌های پیش‌بینی شده با برچسب‌های حقیقی مقایسه شده و دقت محاسبه می‌شود.

## ذخیره و بارگیری مدل

مدل آموزش دیده با استفاده از تابع `torch.save` در یک فایل پیکربندی ذخیره می‌شود. مدل ذخیره شده می‌تواند با استفاده از تابع `torch.load` بارگذاری شود. سپس مدل می‌تواند برای پیش‌بینی یا آموزش بیشتر استفاده شود.

## پیش‌بینی

برای انجام پیش‌بینی با مدل آموزش دیده، می‌توان تصویری را بارگذاری و پردازش کرد. تصویر بارگذاری شده ابتدا به سطح خاکستری تبدیل شده و سپس به صورت آستانه‌ای به تصویر دودویی تبدیل می‌شود. پیکسل‌های غیرصفر برون‌یابی شده و تصویر برش داده می‌شود تا پدینگ صفر حذف شود. تصویر برش‌داده شده به اندازه 32x32 پیکسل تغییر اندازه می‌یابد و به فرمت RGB تبدیل می‌شود. تصویر تغییر اندازه شده نرمال می‌شود و از طریق مدل برای پیش‌بینی عبور می‌کند. برچسب پیش‌بینی شده به همراه تصویر اصلی، تصویر دودویی، تصویر مرکزی دودویی و تصویر با پدینگ نمایش داده می‌شود.

## نتیجه‌گیری

تشخیصگر اعداد فارسی پیاده‌سازی شده در این پروژه نشان می‌دهد که استفاده از GPU برای آموزش مدل‌های یادگیری عمیق به طور مؤثری است. مدل ResNet-50 دقت بالایی را در مجموعه داده Hoda به ارمغان می‌آورد و قابلیت تشخیص تصاویر دست‌نوشته اعداد فارسی را به خوبی نشان می‌دهد. این تشخیصگر می‌تواند در برنامه‌های مختلفی مانند تشخیص متن فارسی با استفاده از تصاویر استفاده شود.
